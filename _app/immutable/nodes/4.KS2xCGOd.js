var gt=Object.defineProperty;var pt=(i,e,s)=>e in i?gt(i,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[e]=s;var Y=(i,e,s)=>(pt(i,typeof e!="symbol"?e+"":e,s),s);import{B as ce,C as ue,s as W,a as B,c as I,i as F,d as D,z as te,D as vt,E as nt,e as me,p as ne,F as we,y as st,G as _t,r as se,u as ie,v as re,w as ae,H as K,I as de,J as it,K as bt,f as wt,g as yt,h as $t,j as Mt,x as St}from"../chunks/scheduler.d5WWJ2dT.js";import{S as V,i as q,b as $,d as M,m as S,a as g,g as ge,t as v,c as pe,e as x,f as ye}from"../chunks/index.Wb0JjX0t.js";import{i as rt,j as X,k as xt,l as at,m as At,I as Et,D as Rt,G as kt,n as Ct,o as Pt,p as Tt,q as zt,r as ot,a as oe,d as le,b as H,s as Ot,t as Dt,w as he,Q as lt,v as jt,x as Se,y as Ft,R as Lt,z as Bt,A as _e,E as xe,F as It,H as ft,J as ct,K as ut,L as Gt,N as Z,P as Ht,S as mt,C as Ae,U as Ee,W as Xt,Y as Nt,Z as Ut,_ as Re,$ as Wt,a0 as Vt,a1 as qt,a2 as Zt,a3 as Kt,c as Yt,a4 as ke,B as Jt,f as Qt,X as en,g as Ce,O as tn,h as nn,V as sn}from"../chunks/BatchedMesh.SQl3Yenh.js";import{w as Pe}from"../chunks/index.5-eZVsyU.js";function Te(i){return(i==null?void 0:i.length)!==void 0?i:Array.from(i)}function rn(i,e){const s="threlte-plugin-context";if(Array.isArray(i)){const[t,n]=i;ce(s,{...ue(s),[t]:n})}else{const t=i,n=e;if(!n)return;ce(s,{...ue(s),[t]:n})}}const ze=new rt,Oe=new X;class De{constructor(e,s,t,n,r){this.controller=s,this.handModel=e,this.envMap=null;let a;!r||!r.primitive||r.primitive==="sphere"?a=new xt(1,10,10):r.primitive==="box"&&(a=new at(1,1,1));const o=new At;this.handMesh=new Et(a,o,30),this.handMesh.frustumCulled=!1,this.handMesh.instanceMatrix.setUsage(Rt),this.handMesh.castShadow=!0,this.handMesh.receiveShadow=!0,this.handModel.add(this.handMesh),this.joints=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"]}updateMesh(){const s=this.controller.joints;let t=0;for(let n=0;n<this.joints.length;n++){const r=s[this.joints[n]];r.visible&&(Oe.setScalar(r.jointRadius||.008),ze.compose(r.position,r.quaternion,Oe),this.handMesh.setMatrixAt(n,ze),t++)}this.handMesh.count=t,this.handMesh.instanceMatrix.needsUpdate=!0}}const an="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles/generic-hand/";class on{constructor(e,s,t,n,r=null){this.controller=s,this.handModel=e,this.bones=[],r===null&&(r=new kt,r.setPath(t||an)),r.load(`${n}.glb`,a=>{const o=a.scene.children[0];this.handModel.add(o);const c=o.getObjectByProperty("type","SkinnedMesh");c.frustumCulled=!1,c.castShadow=!0,c.receiveShadow=!0,["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"].forEach(l=>{const f=o.getObjectByName(l);f!==void 0?f.jointName=l:console.warn(`Couldn't find ${l} in ${n} hand mesh`),this.bones.push(f)})})}updateMesh(){const e=this.controller.joints;for(let s=0;s<this.bones.length;s++){const t=this.bones[s];if(t){const n=e[t.jointName];if(n.visible){const r=n.position;t.position.copy(r),t.quaternion.copy(n.quaternion)}}}}}class ln extends Ct{constructor(e){super(),this.controller=e,this.motionController=null,this.envMap=null,this.mesh=null}updateMatrixWorld(e){super.updateMatrixWorld(e),this.motionController&&this.motionController.updateMesh()}}class fn{constructor(){this.path=null}setPath(e){return this.path=e,this}createHandModel(e,s){const t=new ln(e);return e.addEventListener("connected",n=>{const r=n.data;r.hand&&!t.motionController&&(t.xrInputSource=r,s===void 0||s==="spheres"?t.motionController=new De(t,e,this.path,r.handedness,{primitive:"sphere"}):s==="boxes"?t.motionController=new De(t,e,this.path,r.handedness,{primitive:"box"}):s==="mesh"&&(t.motionController=new on(t,e,this.path,r.handedness))),e.visible=!0}),e.addEventListener("disconnected",()=>{e.visible=!1}),t}}const cn=i=>({}),je=i=>({});function Fe(i){let e,s;return e=new H({props:{is:i[1].hand,name:"XR hand "+i[0],$$slots:{default:[un]},$$scope:{ctx:i}}}),{c(){$(e.$$.fragment)},l(t){M(e.$$.fragment,t)},m(t,n){S(e,t,n),s=!0},p(t,n){const r={};n&2&&(r.is=t[1].hand),n&1&&(r.name="XR hand "+t[0]),n&4136&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){s||(g(e.$$.fragment,t),s=!0)},o(t){v(e.$$.fragment,t),s=!1},d(t){x(e,t)}}}function Le(i){let e,s;return e=new H({props:{is:i[3]}}),{c(){$(e.$$.fragment)},l(t){M(e.$$.fragment,t)},m(t,n){S(e,t,n),s=!0},p(t,n){const r={};n&8&&(r.is=t[3]),e.$set(r)},i(t){s||(g(e.$$.fragment,t),s=!0)},o(t){v(e.$$.fragment,t),s=!1},d(t){x(e,t)}}}function un(i){let e,s,t=i[5].default===void 0&&Le(i);return{c(){t&&t.c(),e=me()},l(n){t&&t.l(n),e=me()},m(n,r){t&&t.m(n,r),F(n,e,r),s=!0},p(n,r){n[5].default===void 0?t?(t.p(n,r),r&32&&g(t,1)):(t=Le(n),t.c(),g(t,1),t.m(e.parentNode,e)):t&&(ge(),v(t,1,1,()=>{t=null}),pe())},i(n){s||(g(t),s=!0)},o(n){v(t),s=!1},d(n){n&&D(e),t&&t.d(n)}}}function mn(i){let e,s;const t=i[10].wrist,n=se(t,i,i[12],je),r=i[10].default,a=se(r,i,i[12],null);return{c(){n&&n.c(),e=B(),a&&a.c()},l(o){n&&n.l(o),e=I(o),a&&a.l(o)},m(o,c){n&&n.m(o,c),F(o,e,c),a&&a.m(o,c),s=!0},p(o,c){n&&n.p&&(!s||c&4096)&&ie(n,t,o,o[12],s?ae(t,o[12],c,cn):re(o[12]),je),a&&a.p&&(!s||c&4096)&&ie(a,r,o,o[12],s?ae(r,o[12],c,null):re(o[12]),null)},i(o){s||(g(n,o),g(a,o),s=!0)},o(o){v(n,o),v(a,o),s=!1},d(o){o&&D(e),n&&n.d(o),a&&a.d(o)}}}function dn(i){let e,s,t;function n(a){i[11](a)}let r={$$slots:{default:[mn]},$$scope:{ctx:i}};return i[2]!==void 0&&(r.ref=i[2]),e=new H.Group({props:r}),ne.push(()=>ye(e,"ref",n)),{c(){$(e.$$.fragment)},l(a){M(e.$$.fragment,a)},m(a,o){S(e,a,o),t=!0},p(a,o){const c={};o&4096&&(c.$$scope={dirty:o,ctx:a}),!s&&o&4&&(s=!0,c.ref=a[2],we(()=>s=!1)),e.$set(c)},i(a){t||(g(e.$$.fragment,a),t=!0)},o(a){v(e.$$.fragment,a),t=!1},d(a){x(e,a)}}}function hn(i){var r;let e,s,t,n=((r=i[1])==null?void 0:r.hand)&&Fe(i);return s=new Pt({props:{$$slots:{default:[dn]},$$scope:{ctx:i}}}),{c(){n&&n.c(),e=B(),$(s.$$.fragment)},l(a){n&&n.l(a),e=I(a),M(s.$$.fragment,a)},m(a,o){n&&n.m(a,o),F(a,e,o),S(s,a,o),t=!0},p(a,[o]){var u;(u=a[1])!=null&&u.hand?n?(n.p(a,o),o&2&&g(n,1)):(n=Fe(a),n.c(),g(n,1),n.m(e.parentNode,e)):n&&(ge(),v(n,1,1,()=>{n=null}),pe());const c={};o&4100&&(c.$$scope={dirty:o,ctx:a}),s.$set(c)},i(a){t||(g(n),g(s.$$.fragment,a),t=!0)},o(a){v(n),v(s.$$.fragment,a),t=!1},d(a){a&&D(e),n&&n.d(a),x(s,a)}}}const gn=new fn,J={left:Ot,right:Dt},Be=new WeakMap;function pn(i,e,s){let t,n,r,a,o,c=st,u=()=>(c(),c=_t(n,m=>s(1,o=m)),n),l;te(i,Tt,m=>s(13,l=m)),i.$$.on_destroy.push(()=>c());let{$$slots:f={},$$scope:d}=e;const k=vt(f);let{left:P=void 0}=e,{right:E=void 0}=e,{hand:A=void 0}=e;const C=zt(),p=ot(),{xr:R}=oe().renderer,_=R.getReferenceSpace(),y=m=>{m.data.handedness===t&&(J[t].set({...Be.get(m.target),inputSource:m.data.hand}),C()&&p("connected",m),m.target.addEventListener("pinchstart",h),m.target.addEventListener("pinchend",h))},T=m=>{m.data.handedness===t&&(J[t].set(void 0),l&&p("disconnected",m),m.target.removeEventListener("pinchstart",h),m.target.removeEventListener("pinchend",h))},h=m=>{p(m.type,m)};let j;const{start:G,stop:b}=le(()=>{var Me;const m=R.getFrame(),w=r.get("wrist");if(w===void 0||_===null)return;const L=(Me=m.getJointPose)==null?void 0:Me.call(m,w,_);if(L==null)return;const{position:O,orientation:fe}=L.transform;j.position.set(O.x,O.y,O.z),j.quaternion.set(fe.x,fe.y,fe.z,fe.w)},{autostart:!1});for(const m of[0,1]){const w=R.getHand(m),L=gn.createHandModel(w,"mesh");Be.set(w,{hand:w,model:L}),w.addEventListener("connected",y),w.addEventListener("disconnected",T)}nt(()=>{var w;for(const L of[0,1]){const O=R.getHand(L);O.removeEventListener("connected",y),O.removeEventListener("disconnected",T)}const m=(w=J[t].current)==null?void 0:w.hand;m==null||m.removeEventListener("pinchstart",h),m==null||m.removeEventListener("pinchend",h),J[t].set(void 0)});function z(m){j=m,s(2,j)}return i.$$set=m=>{"left"in m&&s(6,P=m.left),"right"in m&&s(7,E=m.right),"hand"in m&&s(8,A=m.hand),"$$scope"in m&&s(12,d=m.$$scope)},i.$$.update=()=>{i.$$.dirty&448&&s(0,t=P?"left":E?"right":A),i.$$.dirty&2&&s(9,r=o==null?void 0:o.inputSource),i.$$.dirty&512&&((k.wrist||k.default)&&r?G():b()),i.$$.dirty&1&&u(s(4,n=J[t])),i.$$.dirty&2&&s(3,a=o==null?void 0:o.model)},[t,o,j,a,n,k,P,E,A,r,f,z,d]}class Ie extends V{constructor(e){super(),q(this,e,pn,hn,W,{left:6,right:7,hand:8})}}const vn=(i,e)=>{let s=0,t=e.fixedStep??1/60;return le((n,r)=>{for(s+=r;s>=t;)s-=t,i(n,t)},e)},dt={left:Symbol("teleport-controls-context-left-hand"),right:Symbol("teleport-controls-context-right-hand")},ht=Symbol("teleport-controls-context"),Ge=i=>ue(dt[i]),_n=(i,e)=>{ce(dt[i],e)},$e=()=>ue(ht),bn=i=>{ce(ht,i)},wn=()=>{const i=$e(),e=ot();return{addSurface:a=>{i.interactiveObjects.indexOf(a)>-1||(i.interactiveObjects.push(a),i.surfaces.set(a.uuid,a),i.dispatchers.set(a,e))},removeSurface:a=>{const o=i.interactiveObjects.indexOf(a);i.interactiveObjects.splice(o,1),i.surfaces.delete(a.uuid),i.dispatchers.delete(a)},addBlocker:a=>{i.interactiveObjects.indexOf(a)>-1||(i.interactiveObjects.push(a),i.blockers.set(a.uuid,a))},removeBlocker:a=>{const o=i.interactiveObjects.indexOf(a);i.interactiveObjects.splice(o,1),i.blockers.delete(a.uuid)}}},yn=()=>{const i=()=>{};rn("threlte-teleport-controls",({ref:e,props:s})=>{if(!e.isMesh)return;const t="teleportSurface"in s,n="teleportBlocker"in s;if(!t&&!n)return;const{addBlocker:r,addSurface:a,removeBlocker:o,removeSurface:c}=wn(),u=Pe(e),l=Pe(s);return he([u,l],([f,d])=>t?d.teleportSurface===!1?(c(f),i):(a(f),()=>c(f)):n?s.teleportBlocker===!1?(o(f),i):(r(f),()=>o(f)):i),{onRefChange(f){u.set(f)},onPropsChange(f){l.set(f)}}})},$n=new lt,U={x:0,y:0,z:0},Mn=()=>{const{xr:i}=oe().renderer;let e=i.getReferenceSpace();return(s,t=$n)=>{var a;if(e??(e=i.getReferenceSpace()),e===null)return;Array.isArray(s)?(U.x=-s[0],U.y=-s[1],U.z=-s[2]):(U.x=-s.x,U.y=-s.y,U.z=-s.z);const n=(a=i.getFrame())==null?void 0:a.getViewerPose(e);n!==void 0&&(U.x+=n.transform.position.x,U.z+=n.transform.position.z);const r=new XRRigidTransform(U,t);i.setReferenceSpace(e.getOffsetReferenceSpace(r))}},Sn=(i,e,s=1/40)=>{const t=e.hand,n=Ft(t),r=Mn(),a=()=>{e.hovered.set(void 0),Se[t].set(void 0)},{start:o,stop:c}=vn(()=>{var d;const u=(d=n.current)==null?void 0:d.inputSource.gamepad;if(u===void 0)return;const l=(u.axes[3]??0)<-.8;if(e.active.current&&!l?e.active.set(!1):!e.active.current&&l&&e.active.set(!0),!e.active.current){e.hovered.current!==void 0&&(r(e.hovered.current.point),a());return}i.compute(i,e);const[f]=i.raycaster.intersectObjects(i.interactiveObjects,!0);if(f===void 0){e.hovered.current!==void 0&&a();return}if(f!==void 0&&i.blockers.has(f.object.uuid)){e.hovered.current!==void 0&&a();return}Se[t].set(f),e.hovered.set(f)},{fixedStep:s,autostart:!1});he([jt().isPresenting,e.enabled],([u,l])=>{u&&l?o():c()})};let be=0;const He=(i,e)=>{$e()===void 0&&(yn(),bn({interactiveObjects:[],surfaces:new Map,blockers:new Map,dispatchers:new WeakMap,raycaster:new Lt,compute:(e==null?void 0:e.compute)??Bt}));const s=$e();if(Ge(i)===void 0){const n=(e==null?void 0:e.enabled)??!0;be+=n?1:-1;const r={hand:i,active:_e(!1),enabled:_e(n),hovered:_e(void 0)};_n(i,r),Sn(s,r,e==null?void 0:e.fixedStep)}const t=Ge(i);return he(t.enabled,n=>{be+=n?1:-1,xe.update(r=>(r[i].enabled=be>0,r))}),he(t.active,n=>{xe.update(r=>(r[i].hovering=n,r))}),{enabled:t.enabled,hovered:t.hovered,active:t.active}},xn=Number.parseInt(It.replace("dev","")),Q=(i,e,s,t,n)=>{i[e+0]=s,i[e+1]=t,i[e+2]=n,i[e+3]=s,i[e+4]=t,i[e+5]=n},Xe=(i,e,s,t)=>{i[e+0]=s,i[e+1]=t},Ne=(i,e,s,t,n)=>{i[e+0]=s,i[e+1]=t,i[e+2]=n},An=(i,e,s,t,n,r)=>{i[e+0]=s,i[e+1]=t,i[e+2]=n,i[e+3]=r},En=i=>({}),Ue=i=>({ref:i[1]});function Rn(i){let e;const s=i[7].default,t=se(s,i,i[9],Ue);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,r){t&&t.m(n,r),e=!0},p(n,r){t&&t.p&&(!e||r&512)&&ie(t,s,n,n[9],e?ae(s,n[9],r,En):re(n[9]),Ue)},i(n){e||(g(t,n),e=!0)},o(n){v(t,n),e=!1},d(n){t&&t.d(n)}}}function kn(i){let e,s;const t=[{is:i[1]},i[3]];let n={$$slots:{default:[Rn]},$$scope:{ctx:i}};for(let r=0;r<t.length;r+=1)n=K(n,t[r]);return e=new H({props:n}),i[8](e),{c(){$(e.$$.fragment)},l(r){M(e.$$.fragment,r)},m(r,a){S(e,r,a),s=!0},p(r,[a]){const o=a&10?ft(t,[a&2&&{is:r[1]},a&8&&ct(r[3])]):{};a&512&&(o.$$scope={dirty:a,ctx:r}),e.$set(o)},i(r){s||(g(e.$$.fragment,r),s=!0)},o(r){v(e.$$.fragment,r),s=!1},d(r){i[8](null),x(e,r)}}}function Cn(i,e,s){const t=["points","shape","shapeFunction"];let n=de(e,t),r,{$$slots:a={},$$scope:o}=e,{points:c=[]}=e,{shape:u="none"}=e,{shapeFunction:l=p=>1}=e,f;const{invalidate:d}=oe(),P=(()=>{f=c.length;let p=[],R=0,_=[],y=[],T=0,h=[],j=0,G=[],b=0;u==="taper"&&s(4,l=m=>1*Math.pow(4*m*(1-m),1));for(let m=0;m<f;m++){const w=m/c.length;p[R+0]=w,p[R+1]=w,R+=2,Xe(_,T,1,-1);let L=u==="none"?1:l(m/(f-1));if(Xe(y,T,L,L),T+=2,An(h,j,m/(f-1),0,m/(f-1),1),j+=4,m<f-1){const O=m*2;Ne(G,b,O+0,O+1,O+2),Ne(G,b+3,O+2,O+1,O+3),b+=6}}const z=new Gt;return z.setAttribute("position",new Z(new Float32Array(f*6),3)),z.setAttribute("previous",new Z(new Float32Array(f*6),3)),z.setAttribute("next",new Z(new Float32Array(f*6),3)),z.setAttribute("counters",new Z(new Float32Array(p),1)),z.setAttribute("side",new Z(new Float32Array(_),1)),z.setAttribute("width",new Z(new Float32Array(y),1)),z.setAttribute("uv",new Z(new Float32Array(h),2)),z.setIndex(new Z(new Uint16Array(G),1)),z})(),E=p=>{if(!p[0]||p.length!=f)return;let R=[],_=[],y=[],T=0,h=0,j=0;Q(_,h,p[0].x,p[0].y,p[0].z),h+=6;for(let m=0;m<f;m++){const w=p[m];Q(R,T,w.x,w.y,w.z),T+=6,m<f-1&&(Q(_,h,w.x,w.y,w.z),h+=6),m>0&&m+1<=f&&(Q(y,j,w.x,w.y,w.z),j+=6)}Q(y,j,p[f-1].x,p[f-1].y,p[f-1].z);const G=P.getAttribute("position").set(R),b=P.getAttribute("previous").set(_),z=P.getAttribute("next").set(y);G.needsUpdate=!0,b.needsUpdate=!0,z.needsUpdate=!0,P.computeBoundingSphere(),d("Meshline points changed")},A=ut();te(i,A,p=>s(0,r=p));function C(p){ne[p?"unshift":"push"](()=>{r=p,A.set(r)})}return i.$$set=p=>{e=K(K({},e),it(p)),s(3,n=de(e,t)),"points"in p&&s(5,c=p.points),"shape"in p&&s(6,u=p.shape),"shapeFunction"in p&&s(4,l=p.shapeFunction),"$$scope"in p&&s(9,o=p.$$scope)},i.$$.update=()=>{i.$$.dirty&32&&E(c)},[r,P,A,n,l,c,u,a,C,o]}class Pn extends V{constructor(e){super(),q(this,e,Cn,kn,W,{points:5,shape:6,shapeFunction:4})}}const Tn=`
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>

uniform float useDash;
uniform float dashArray;
uniform float dashOffset;
uniform float dashRatio;
uniform sampler2D alphaMap;
uniform float useAlphaMap;

varying vec2 vUV;
varying vec4 vColor;
varying float vCounters;

void main()	{
	#include <logdepthbuf_fragment>
	#include <${xn<154?"encodings_fragment":"colorspace_fragment"}>

	vec4 c = vColor;

	if( useAlphaMap == 1. ) c.a *= texture2D( alphaMap, vUV ).r;

	if( useDash == 1. ){
			c.a *= ceil(mod(vCounters + dashOffset, dashArray) - (dashArray * dashRatio));
	}

	gl_FragColor = LinearTosRGB(c);
}
`,zn=i=>({ref:i&1}),We=i=>({ref:i[0]});function On(i){let e;const s=i[15].default,t=se(s,i,i[17],We);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,r){t&&t.m(n,r),e=!0},p(n,r){t&&t.p&&(!e||r&131073)&&ie(t,s,n,n[17],e?ae(s,n[17],r,zn):re(n[17]),We)},i(n){e||(g(t,n),e=!0)},o(n){v(t,n),e=!1},d(n){t&&t.d(n)}}}function Dn(i){let e,s;const t=[{is:i[0]},i[4],{fragmentShader:Tn},{vertexShader:Ht}];let n={$$slots:{default:[On]},$$scope:{ctx:i}};for(let r=0;r<t.length;r+=1)n=K(n,t[r]);return e=new H({props:n}),i[16](e),{c(){$(e.$$.fragment)},l(r){M(e.$$.fragment,r)},m(r,a){S(e,r,a),s=!0},p(r,[a]){const o=a&17?ft(t,[a&1&&{is:r[0]},a&16&&ct(r[4]),t[2],t[3]]):{};a&131073&&(o.$$scope={dirty:a,ctx:r}),e.$set(o)},i(r){s||(g(e.$$.fragment,r),s=!0)},o(r){v(e.$$.fragment,r),s=!1},d(r){i[16](null),x(e,r)}}}function jn(i,e,s){const t=["opacity","color","dashOffset","dashArray","dashRatio","attenuate","width","scaleDown","alphaMap"];let n=de(e,t),r,a,{$$slots:o={},$$scope:c}=e,{opacity:u=1}=e,{color:l="#ffffff"}=e,{dashOffset:f=0}=e,{dashArray:d=0}=e,{dashRatio:k=0}=e,{attenuate:P=!0}=e,{width:E=1}=e,{scaleDown:A=0}=e,{alphaMap:C=void 0}=e,{invalidate:p,size:R}=oe();te(i,R,h=>s(14,r=h));const _=new mt({uniforms:{lineWidth:{value:E},color:{value:new Ae(l)},opacity:{value:u},resolution:{value:new Ee(1,1)},sizeAttenuation:{value:P?1:0},dashArray:{value:d},dashOffset:{value:f},dashRatio:{value:k},useDash:{value:d>0?1:0},scaleDown:{value:A/10},alphaTest:{value:0},alphaMap:{value:C},useAlphaMap:{value:C?1:0}}}),y=ut();te(i,y,h=>s(1,a=h));function T(h){ne[h?"unshift":"push"](()=>{a=h,y.set(a)})}return i.$$set=h=>{e=K(K({},e),it(h)),s(4,n=de(e,t)),"opacity"in h&&s(5,u=h.opacity),"color"in h&&s(6,l=h.color),"dashOffset"in h&&s(7,f=h.dashOffset),"dashArray"in h&&s(8,d=h.dashArray),"dashRatio"in h&&s(9,k=h.dashRatio),"attenuate"in h&&s(10,P=h.attenuate),"width"in h&&s(11,E=h.width),"scaleDown"in h&&s(12,A=h.scaleDown),"alphaMap"in h&&s(13,C=h.alphaMap),"$$scope"in h&&s(17,c=h.$$scope)},i.$$.update=()=>{i.$$.dirty&16384&&(s(0,_.uniforms.resolution.value=new Ee(r.width,r.height),_),p("Canvas size changed")),i.$$.dirty&3040&&(s(0,_.uniforms.dashRatio.value=k,_),s(0,_.uniforms.dashArray.value=d,_),s(0,_.uniforms.dashOffset.value=f,_),s(0,_.uniforms.lineWidth.value=E,_),s(0,_.uniforms.opacity.value=u,_),s(0,_.uniforms.color.value=new Ae(l),_),p("MeshLineMaterial uniforms changed"))},[_,a,R,y,n,u,l,f,d,k,P,E,A,C,r,o,T,c]}class Fn extends V{constructor(e){super(),q(this,e,jn,Dn,W,{opacity:5,color:6,dashOffset:7,dashArray:8,dashRatio:9,attenuate:10,width:11,scaleDown:12,alphaMap:13})}}class ve extends Xt{constructor(){const e=ve.SkyShader,s=new mt({name:e.name,uniforms:Nt.clone(e.uniforms),vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,side:Ut,depthWrite:!1});super(new at(1,1,1),s),this.isSky=!0}}ve.SkyShader={name:"SkyShader",uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new X},up:{value:new X(0,1,0)}},vertexShader:`
		uniform vec3 sunPosition;
		uniform float rayleigh;
		uniform float turbidity;
		uniform float mieCoefficient;
		uniform vec3 up;

		varying vec3 vWorldPosition;
		varying vec3 vSunDirection;
		varying float vSunfade;
		varying vec3 vBetaR;
		varying vec3 vBetaM;
		varying float vSunE;

		// constants for atmospheric scattering
		const float e = 2.71828182845904523536028747135266249775724709369995957;
		const float pi = 3.141592653589793238462643383279502884197169;

		// wavelength of used primaries, according to preetham
		const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
		// this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
		// (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
		const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

		// mie stuff
		// K coefficient for the primaries
		const float v = 4.0;
		const vec3 K = vec3( 0.686, 0.678, 0.666 );
		// MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
		const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

		// earth shadow hack
		// cutoffAngle = pi / 1.95;
		const float cutoffAngle = 1.6110731556870734;
		const float steepness = 1.5;
		const float EE = 1000.0;

		float sunIntensity( float zenithAngleCos ) {
			zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
			return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
		}

		vec3 totalMie( float T ) {
			float c = ( 0.2 * T ) * 10E-18;
			return 0.434 * c * MieConst;
		}

		void main() {

			vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
			vWorldPosition = worldPosition.xyz;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			gl_Position.z = gl_Position.w; // set z to camera.far

			vSunDirection = normalize( sunPosition );

			vSunE = sunIntensity( dot( vSunDirection, up ) );

			vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

			float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

			// extinction (absorbtion + out scattering)
			// rayleigh coefficients
			vBetaR = totalRayleigh * rayleighCoefficient;

			// mie coefficients
			vBetaM = totalMie( turbidity ) * mieCoefficient;

		}`,fragmentShader:`
		varying vec3 vWorldPosition;
		varying vec3 vSunDirection;
		varying float vSunfade;
		varying vec3 vBetaR;
		varying vec3 vBetaM;
		varying float vSunE;

		uniform float mieDirectionalG;
		uniform vec3 up;

		// constants for atmospheric scattering
		const float pi = 3.141592653589793238462643383279502884197169;

		const float n = 1.0003; // refractive index of air
		const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

		// optical length at zenith for molecules
		const float rayleighZenithLength = 8.4E3;
		const float mieZenithLength = 1.25E3;
		// 66 arc seconds -> degrees, and the cosine of that
		const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

		// 3.0 / ( 16.0 * pi )
		const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
		// 1.0 / ( 4.0 * pi )
		const float ONE_OVER_FOURPI = 0.07957747154594767;

		float rayleighPhase( float cosTheta ) {
			return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
		}

		float hgPhase( float cosTheta, float g ) {
			float g2 = pow( g, 2.0 );
			float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
			return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
		}

		void main() {

			vec3 direction = normalize( vWorldPosition - cameraPosition );

			// optical length
			// cutoff angle at 90 to avoid singularity in next formula.
			float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
			float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
			float sR = rayleighZenithLength * inverse;
			float sM = mieZenithLength * inverse;

			// combined extinction factor
			vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

			// in scattering
			float cosTheta = dot( direction, vSunDirection );

			float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
			vec3 betaRTheta = vBetaR * rPhase;

			float mPhase = hgPhase( cosTheta, mieDirectionalG );
			vec3 betaMTheta = vBetaM * mPhase;

			vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
			Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

			// nightsky
			float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
			float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
			vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
			vec3 L0 = vec3( 0.1 ) * Fex;

			// composition + solar disc
			float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
			L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

			vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

			vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

			gl_FragColor = vec4( retColor, 1.0 );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>

		}`};const Ln=i=>({renderTarget:i&1}),Ve=i=>({sunPosition:i[2],renderTarget:i[0]});function Bn(i){let e;const s=i[13].default,t=se(s,i,i[14],Ve);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,r){t&&t.m(n,r),e=!0},p(n,r){t&&t.p&&(!e||r&16385)&&ie(t,s,n,n[14],e?ae(s,n[14],r,Ln):re(n[14]),Ve)},i(n){e||(g(t,n),e=!0)},o(n){v(t,n),e=!1},d(n){t&&t.d(n)}}}function In(i){let e,s;return e=new H({props:{is:i[1],$$slots:{default:[Bn]},$$scope:{ctx:i}}}),{c(){$(e.$$.fragment)},l(t){M(e.$$.fragment,t)},m(t,n){S(e,t,n),s=!0},p(t,[n]){const r={};n&16385&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){s||(g(e.$$.fragment,t),s=!0)},o(t){v(e.$$.fragment,t),s=!1},d(t){x(e,t)}}}function Gn(i,e,s){let{$$slots:t={},$$scope:n}=e,{scale:r=1e3}=e,{turbidity:a=10}=e,{rayleigh:o=3}=e,{mieCoefficient:c=.005}=e,{mieDirectionalG:u=.7}=e,{elevation:l=2}=e,{azimuth:f=180}=e,{setEnvironment:d=!0}=e,{cubeMapSize:k=128}=e,{webGLRenderTargetOptions:P={}}=e;const E=new ve,A=new X,C=E.material.uniforms,{renderer:p,scene:R}=oe();let _,y;const T=()=>{s(0,_=new Wt(k,{type:Vt,generateMipmaps:!0,minFilter:qt,...P})),y=new Zt(1,1.1,_)},h=R.environment,{start:j,stop:G}=le(({invalidate:b})=>{E.scale.setScalar(r),C.turbidity.value=a,C.rayleigh.value=o,C.mieCoefficient.value=c,C.mieDirectionalG.value=u;const z=Re.degToRad(90-l),m=Re.degToRad(f);A.setFromSphericalCoords(1,z,m),C.sunPosition.value.copy(A),d&&((!_||!y)&&T(),y==null||y.update(p,E)),b(),G()},{autostart:!1});return nt(()=>{E.material.dispose(),_==null||_.dispose(),R.environment=h}),i.$$set=b=>{"scale"in b&&s(3,r=b.scale),"turbidity"in b&&s(4,a=b.turbidity),"rayleigh"in b&&s(5,o=b.rayleigh),"mieCoefficient"in b&&s(6,c=b.mieCoefficient),"mieDirectionalG"in b&&s(7,u=b.mieDirectionalG),"elevation"in b&&s(8,l=b.elevation),"azimuth"in b&&s(9,f=b.azimuth),"setEnvironment"in b&&s(10,d=b.setEnvironment),"cubeMapSize"in b&&s(11,k=b.cubeMapSize),"webGLRenderTargetOptions"in b&&s(12,P=b.webGLRenderTargetOptions),"$$scope"in b&&s(14,n=b.$$scope)},i.$$.update=()=>{i.$$.dirty&1025&&(d&&_?R.environment=_.texture:d||(R.environment=h)),i.$$.dirty&1016&&j()},[_,E,A,r,a,o,c,u,l,f,d,k,P,t,n]}class Hn extends V{constructor(e){super(),q(this,e,Gn,In,W,{scale:3,turbidity:4,rayleigh:5,mieCoefficient:6,mieDirectionalG:7,elevation:8,azimuth:9,setEnvironment:10,cubeMapSize:11,webGLRenderTargetOptions:12})}}const Xn=.5*(Math.sqrt(3)-1),ee=(3-Math.sqrt(3))/6,qe=i=>Math.floor(i)|0,Ze=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]);function Ke(i=Math.random){const e=Nn(i),s=new Float64Array(e).map(n=>Ze[n%12*2]),t=new Float64Array(e).map(n=>Ze[n%12*2+1]);return function(r,a){let o=0,c=0,u=0;const l=(r+a)*Xn,f=qe(r+l),d=qe(a+l),k=(f+d)*ee,P=f-k,E=d-k,A=r-P,C=a-E;let p,R;A>C?(p=1,R=0):(p=0,R=1);const _=A-p+ee,y=C-R+ee,T=A-1+2*ee,h=C-1+2*ee,j=f&255,G=d&255;let b=.5-A*A-C*C;if(b>=0){const w=j+e[G],L=s[w],O=t[w];b*=b,o=b*b*(L*A+O*C)}let z=.5-_*_-y*y;if(z>=0){const w=j+p+e[G+R],L=s[w],O=t[w];z*=z,c=z*z*(L*_+O*y)}let m=.5-T*T-h*h;if(m>=0){const w=j+1+e[G+1],L=s[w],O=t[w];m*=m,u=m*m*(L*T+O*h)}return 70*(o+c+u)}}function Nn(i){const s=new Uint8Array(512);for(let t=0;t<512/2;t++)s[t]=t;for(let t=0;t<512/2-1;t++){const n=t+~~(i()*(256-t)),r=s[t];s[t]=s[n],s[n]=r}for(let t=256;t<512;t++)s[t]=s[t-256];return s}function Ye(i,e,s){const t=i.slice();return t[7]=e[s],t[9]=s,t}function Un(i){let e,s,t,n,r;return e=new Pn({props:{points:i[2][i[9]],shape:"taper"}}),t=new Fn({props:{opacity:i[7].opacity,transparent:!0,dashArray:1,dashRatio:.8,dashOffset:i[7].dashOffset,depthWrite:!1,width:.04,color:"#DFD4B4"}}),{c(){$(e.$$.fragment),s=B(),$(t.$$.fragment),n=B()},l(a){M(e.$$.fragment,a),s=I(a),M(t.$$.fragment,a),n=I(a)},m(a,o){S(e,a,o),F(a,s,o),S(t,a,o),F(a,n,o),r=!0},p(a,o){const c={};o&2&&(c.opacity=a[7].opacity),o&2&&(c.dashOffset=a[7].dashOffset),t.$set(c)},i(a){r||(g(e.$$.fragment,a),g(t.$$.fragment,a),r=!0)},o(a){v(e.$$.fragment,a),v(t.$$.fragment,a),r=!1},d(a){a&&(D(s),D(n)),x(e,a),x(t,a)}}}function Je(i){let e,s;return e=new H.Mesh({props:{"position.x":i[7].x,"position.z":i[7].z,$$slots:{default:[Un]},$$scope:{ctx:i}}}),{c(){$(e.$$.fragment)},l(t){M(e.$$.fragment,t)},m(t,n){S(e,t,n),s=!0},p(t,n){const r={};n&2&&(r["position.x"]=t[7].x),n&2&&(r["position.z"]=t[7].z),n&1026&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){s||(g(e.$$.fragment,t),s=!0)},o(t){v(e.$$.fragment,t),s=!1},d(t){x(e,t)}}}function Wn(i){let e,s,t=Te(i[1]),n=[];for(let a=0;a<t.length;a+=1)n[a]=Je(Ye(i,t,a));const r=a=>v(n[a],1,1,()=>{n[a]=null});return{c(){for(let a=0;a<n.length;a+=1)n[a].c();e=me()},l(a){for(let o=0;o<n.length;o+=1)n[o].l(a);e=me()},m(a,o){for(let c=0;c<n.length;c+=1)n[c]&&n[c].m(a,o);F(a,e,o),s=!0},p(a,o){if(o&6){t=Te(a[1]);let c;for(c=0;c<t.length;c+=1){const u=Ye(a,t,c);n[c]?(n[c].p(u,o),g(n[c],1)):(n[c]=Je(u),n[c].c(),g(n[c],1),n[c].m(e.parentNode,e))}for(ge(),c=t.length;c<n.length;c+=1)r(c);pe()}},i(a){if(!s){for(let o=0;o<t.length;o+=1)g(n[o]);s=!0}},o(a){n=n.filter(Boolean);for(let o=0;o<n.length;o+=1)v(n[o]);s=!1},d(a){a&&D(e),bt(n,a)}}}function Vn(i){let e,s;return e=new H.Group({props:{position:i[0],$$slots:{default:[Wn]},$$scope:{ctx:i}}}),{c(){$(e.$$.fragment)},l(t){M(e.$$.fragment,t)},m(t,n){S(e,t,n),s=!0},p(t,[n]){const r={};n&1&&(r.position=t[0]),n&1026&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){s||(g(e.$$.fragment,t),s=!0)},o(t){v(e.$$.fragment,t),s=!1},d(t){x(e,t)}}}const N=()=>Math.random();class qn{constructor(e){Y(this,"z");Y(this,"x");Y(this,"opacity");Y(this,"dashOffset",0);this.z=0,this.x=0,this.opacity=0}}let Qe=3;function Zn(i,e,s){let{offset:t=0}=e,{position:n=[0,0,0]}=e,r=new Array(Qe).fill(0).map((l,f)=>f);const a=[],o=[];function c(){const l=[];l.push(new X(N()/1.5,N()/2,6)),l.push(new X(N()/1.5,N()/2,4)),l.push(new X(N()/1.5,N()/2,0)),l.push(new X(N()/1.5,N()/2,-4)),l.push(new X(N()/1.5,N()/2,-6));const f=new Kt(l);o.push(f.getPoints(20))}function u(){s(1,a.length=0,a);for(let l=0;l<Qe;l++)a.push(new qn(l)),c()}return u(),le((l,f)=>{if(f<.5){s(3,t+=.4*f);for(let d=0;d<r.length;d++)t<.5?s(1,a[d].opacity+=f*(d*.2),a):s(1,a[d].opacity-=f*(d*.2),a),s(1,a[d].dashOffset=-t-.1,a)}if(t>3){s(3,t=0);for(let d=0;d<r.length;d++)s(1,a[d].opacity=0,a)}}),i.$$set=l=>{"offset"in l&&s(3,t=l.offset),"position"in l&&s(0,n=l.position)},[n,a,o,t]}class et extends V{constructor(e){super(),q(this,e,Zn,Vn,W,{offset:3,position:0})}}function Kn(i){let e,s,t,n;return e=new H({props:{is:i[0],teleportSurface:!0,visible:!1}}),t=new H({props:{is:i[1],teleportBlocker:!0,visible:!1}}),{c(){$(e.$$.fragment),s=B(),$(t.$$.fragment)},l(r){M(e.$$.fragment,r),s=I(r),M(t.$$.fragment,r)},m(r,a){S(e,r,a),F(r,s,a),S(t,r,a),n=!0},p(r,[a]){const o={};a&1&&(o.is=r[0]),e.$set(o);const c={};a&2&&(c.is=r[1]),t.$set(c)},i(r){n||(g(e.$$.fragment,r),g(t.$$.fragment,r),n=!0)},o(r){v(e.$$.fragment,r),v(t.$$.fragment,r),n=!1},d(r){r&&D(s),x(e,r),x(t,r)}}}function Yn(i,e,s){let{surface:t}=e,{blocker:n}=e;return i.$$set=r=>{"surface"in r&&s(0,t=r.surface),"blocker"in r&&s(1,n=r.blocker)},[t,n]}class Jn extends V{constructor(e){super(),q(this,e,Yn,Kn,W,{surface:0,blocker:1})}}function tt(i){let e,s,t,n,r,a;function o(l){i[5](l)}function c(l){i[6](l)}let u={material:i[2].materials.Composition,object:i[2].scene,filter:es};return i[0]!==void 0&&(u.ids=i[0]),i[1]!==void 0&&(u.mesh=i[1]),e=new Jt({props:u}),ne.push(()=>ye(e,"ids",o)),ne.push(()=>ye(e,"mesh",c)),e.$on("create",i[7]),r=new Jn({props:{surface:i[2].nodes.TeleportSurface,blocker:i[2].nodes.TeleportBlocker}}),{c(){$(e.$$.fragment),n=B(),$(r.$$.fragment)},l(l){M(e.$$.fragment,l),n=I(l),M(r.$$.fragment,l)},m(l,f){S(e,l,f),F(l,n,f),S(r,l,f),a=!0},p(l,f){const d={};f&4&&(d.material=l[2].materials.Composition),f&4&&(d.object=l[2].scene),!s&&f&1&&(s=!0,d.ids=l[0],we(()=>s=!1)),!t&&f&2&&(t=!0,d.mesh=l[1],we(()=>t=!1)),e.$set(d);const k={};f&4&&(k.surface=l[2].nodes.TeleportSurface),f&4&&(k.blocker=l[2].nodes.TeleportBlocker),r.$set(k)},i(l){a||(g(e.$$.fragment,l),g(r.$$.fragment,l),a=!0)},o(l){v(e.$$.fragment,l),v(r.$$.fragment,l),a=!1},d(l){l&&D(n),x(e,l),x(r,l)}}}function Qn(i){let e,s,t,n,r,a,o,c,u,l=i[2]&&tt(i);return s=new Hn({props:{elevation:0,azimuth:-90}}),n=new et({props:{position:[5,1,-2],offset:1}}),a=new et({props:{position:[0,1,-8]}}),c=new H.AmbientLight({}),{c(){l&&l.c(),e=B(),$(s.$$.fragment),t=B(),$(n.$$.fragment),r=B(),$(a.$$.fragment),o=B(),$(c.$$.fragment)},l(f){l&&l.l(f),e=I(f),M(s.$$.fragment,f),t=I(f),M(n.$$.fragment,f),r=I(f),M(a.$$.fragment,f),o=I(f),M(c.$$.fragment,f)},m(f,d){l&&l.m(f,d),F(f,e,d),S(s,f,d),F(f,t,d),S(n,f,d),F(f,r,d),S(a,f,d),F(f,o,d),S(c,f,d),u=!0},p(f,[d]){f[2]?l?(l.p(f,d),d&4&&g(l,1)):(l=tt(f),l.c(),g(l,1),l.m(e.parentNode,e)):l&&(ge(),v(l,1,1,()=>{l=null}),pe())},i(f){u||(g(l),g(s.$$.fragment,f),g(n.$$.fragment,f),g(a.$$.fragment,f),g(c.$$.fragment,f),u=!0)},o(f){v(l),v(s.$$.fragment,f),v(n.$$.fragment,f),v(a.$$.fragment,f),v(c.$$.fragment,f),u=!1},d(f){f&&(D(e),D(t),D(r),D(o)),l&&l.d(f),x(s,f),x(n,f),x(a,f),x(c,f)}}}const es=i=>i.name.includes("Teleport")===!1;function ts(i,e,s){let t;const n=Yt("./scene_vr.glb");te(i,n,y=>s(2,t=y));const r=Ke(),a=Ke();let o,c;const u=new X,l=new ke,f=new lt,d=new X(1,1,1),k=new rt,P=new ke;let E=0;const A=(y,T)=>{const h=o.get(y);c.getMatrixAt(h,k),k.decompose(u,f,d),f.setFromEuler(T),k.compose(u,f,d),c.setMatrixAt(h,k)},{start:C}=le((y,T)=>{E+=T,l.set(r(E/4,0)/2.5+.4,0,r(0,E/4)/4.5),A("Lamp1",l),P.x+=.2,A("Prop1",P);for(const h of[1,2,3,4])l.set(0,0,r(E/16,0)/10+a(E*2,0)/7-h/5),A(`Shutter${h}`,l);l.set(0,0,r(0,E)/10+Math.PI/16),A("Panel1",l),l.set(r(E/2,0)/15+Math.PI/8,0,0),A("Panel2",l),l.set(r(0,E)*2,0,0),A("Dial1",l),l.set(r(E,0)*3+2,0,0),A("Dial2",l)},{autostart:!1});function p(y){o=y,s(0,o)}function R(y){c=y,s(1,c)}return[o,c,t,n,C,p,R,()=>{console.log(o),C()}]}class ns extends V{constructor(e){super(),q(this,e,ts,Qn,W,{})}}function ss(i){let e,s,t,n,r,a,o,c;return e=new Ce({props:{left:!0}}),t=new Ce({props:{right:!0}}),r=new Ie({props:{left:!0}}),o=new Ie({props:{right:!0}}),{c(){$(e.$$.fragment),s=B(),$(t.$$.fragment),n=B(),$(r.$$.fragment),a=B(),$(o.$$.fragment)},l(u){M(e.$$.fragment,u),s=I(u),M(t.$$.fragment,u),n=I(u),M(r.$$.fragment,u),a=I(u),M(o.$$.fragment,u)},m(u,l){S(e,u,l),F(u,s,l),S(t,u,l),F(u,n,l),S(r,u,l),F(u,a,l),S(o,u,l),c=!0},p:st,i(u){c||(g(e.$$.fragment,u),g(t.$$.fragment,u),g(r.$$.fragment,u),g(o.$$.fragment,u),c=!0)},o(u){v(e.$$.fragment,u),v(t.$$.fragment,u),v(r.$$.fragment,u),v(o.$$.fragment,u),c=!1},d(u){u&&(D(s),D(n),D(a)),x(e,u),x(t,u),x(r,u),x(o,u)}}}function is(i){let e,s;return e=new tn({}),{c(){$(e.$$.fragment)},l(t){M(e.$$.fragment,t)},m(t,n){S(e,t,n),s=!0},i(t){s||(g(e.$$.fragment,t),s=!0)},o(t){v(e.$$.fragment,t),s=!1},d(t){x(e,t)}}}function rs(i){let e,s;return e=new H.PerspectiveCamera({props:{slot:"fallback",makeDefault:!0,position:[23,6,-8],$$slots:{default:[is]},$$scope:{ctx:i}}}),{c(){$(e.$$.fragment)},l(t){M(e.$$.fragment,t)},m(t,n){S(e,t,n),s=!0},p(t,n){const r={};n&1&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){s||(g(e.$$.fragment,t),s=!0)},o(t){v(e.$$.fragment,t),s=!1},d(t){x(e,t)}}}function as(i){let e,s,t,n,r,a;return e=new Qt({}),t=new en({props:{$$slots:{fallback:[rs],default:[ss]},$$scope:{ctx:i}}}),r=new ns({}),{c(){$(e.$$.fragment),s=B(),$(t.$$.fragment),n=B(),$(r.$$.fragment)},l(o){M(e.$$.fragment,o),s=I(o),M(t.$$.fragment,o),n=I(o),M(r.$$.fragment,o)},m(o,c){S(e,o,c),F(o,s,c),S(t,o,c),F(o,n,c),S(r,o,c),a=!0},p(o,[c]){const u={};c&1&&(u.$$scope={dirty:c,ctx:o}),t.$set(u)},i(o){a||(g(e.$$.fragment,o),g(t.$$.fragment,o),g(r.$$.fragment,o),a=!0)},o(o){v(e.$$.fragment,o),v(t.$$.fragment,o),v(r.$$.fragment,o),a=!1},d(o){o&&(D(s),D(n)),x(e,o),x(t,o),x(r,o)}}}function os(i){return He("left"),He("right"),[]}class ls extends V{constructor(e){super(),q(this,e,os,as,W,{})}}function fs(i){let e,s;return e=new ls({}),{c(){$(e.$$.fragment)},l(t){M(e.$$.fragment,t)},m(t,n){S(e,t,n),s=!0},i(t){s||(g(e.$$.fragment,t),s=!0)},o(t){v(e.$$.fragment,t),s=!1},d(t){x(e,t)}}}function cs(i){let e,s,t,n,r;return s=new nn({props:{$$slots:{default:[fs]},$$scope:{ctx:i}}}),n=new sn({}),{c(){e=wt("div"),$(s.$$.fragment),t=B(),$(n.$$.fragment),this.h()},l(a){e=yt(a,"DIV",{class:!0});var o=$t(e);M(s.$$.fragment,o),t=I(o),M(n.$$.fragment,o),o.forEach(D),this.h()},h(){Mt(e,"class","svelte-12k73yi")},m(a,o){F(a,e,o),S(s,e,null),St(e,t),S(n,e,null),r=!0},p(a,[o]){const c={};o&1&&(c.$$scope={dirty:o,ctx:a}),s.$set(c)},i(a){r||(g(s.$$.fragment,a),g(n.$$.fragment,a),r=!0)},o(a){v(s.$$.fragment,a),v(n.$$.fragment,a),r=!1},d(a){a&&D(e),x(s),x(n)}}}class ps extends V{constructor(e){super(),q(this,e,null,cs,W,{})}}export{ps as component};
